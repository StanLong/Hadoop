# Shell编程

## 介绍

shell是一个程序，采用C语言编写，是用户和Linux内核沟通的桥梁，它既是一种命令语言，又是一种解释性的编程语言。如下图所示

![](./doc/01.png)

## 功能

- 命令行解释功能
- 启动程序
- 输入输出重定向
- 管道连接
- 文件名替换(echo /*)
- 变量维护
- 环境控制

## 特殊符号

| 符号            | 含义                                                         |
| --------------- | ------------------------------------------------------------ |
| #               | 注释作用, #! 除外                                            |
| ;               | 命令行分隔符, 可以在一行中写多个命令. 例如p1;p2表示先执行p1,再执行p2 |
| ;;              | 连续分号 ,终止 case 选项                                     |
| ""              | 双引号，软转义，解释变量的内容                               |
| ''              | 单引号，硬转义，内容原样输出，不解释变量                     |
| \|              | 管道, 分析前边命令的输出, 并将输出作为后边命令的输入.        |
| >\|             | 强制重定向                                                   |
| \|\|            | 逻辑或，前一个命令执行失败后，才继续执行下一个命令。         |
| ()              | 指令群组 ,用括号将一串连续指令括起来,如 ``` (cd ~ ; vcgh=`pwd` ;echo $vcgh)``` |
| &               | 后台运行命令                                                 |
| &&              | 逻辑与，前一个命令执行成功后，才继续执行下一个命令。         |
| !               | 执行历史记录中的命令，"!!"执行上一条命令                     |
| >/dev/null 2>&1 | 标准输出和标准错误都重定向到了/dev/null                      |
| 2>&1 >/dev/null | 意思是把标准错误输出重定向到标准输出后重定向到/dev/null      |
| 1>&2 >/dev/null | 意思是把标准输出重定向到标准错误后重定向到/dev/null          |
| &> /dev/null    | 不管你是啥玩意儿文件描述符，通通重定向到/dev/null            |

## 重定向

```shell
>    重定向输入 覆盖原数据
>>   重定向追加输入，在原数据的末尾添加
<    重定向输出  例如： wc -l < /etc/paawd
<<   重定向追加输出  例如: fdisk /dev/sdb <<EOF ... EOF # 追加输入的内容为 fdisk 需要的参数
```

## 数学运算

```shell
[root@node01 ~]# expr 1 + 1 expr 命令: 只能做整数运算， 注意空格
2
[root@node01 ~]# expr 5 \* 2  # 乘法运算需要转义
10
[root@node01 ~]# echo $((100+3)) # (()) 也可以做数学运算
103
```

## 退出脚本

```shell
exit num 退出脚本，num 代表一个返回值范围是1-255
```

## 格式化输入输出

**echo** 

-n 不要自动换行

```shell
[root@node01 ~]# echo -n "date: ";date +%F
date:2021-11-02
```

-e 若字符串中出现转义字符，则需要特别处理，不会将转义字符当成一般文字输出

转义字符： 

\a 发出告警声

\b 删除前一个字符

```shell
# 倒计时脚本
# time.sh

#!/bin/bash
for time in `seq 9 -1 0`;do
	echo -n -e "\b$time"
	sleep 1
done

echo
```

**颜色代码**

```shell
[root@node01 ~]# echo -e "\033[背景色;字体颜色 字符串 \033[属性效果"
```

